ugly details about the bytecode language where string pointers occur

in the byte sequences below, ## ## ## ## is the string pointer

the extremely lazy way to match:
1f 00 01 00 ## ## ## ##
- this results in a bunch of false hits, but catches nearly everything

normal text line
1f 00 01 00 10 39 00 00 1F 00 01 00 2B 39 00 00 1F 00 01 00 FF FF FF 0F 17 00 01 00 02 00 02 00 00 00 00 00
1F 00 01 00 A2 76 01 00 1F 00 01 00 CD 76 01 00 1F 00 01 00 10 0D 00 00 17 00 01 00 0F 00 02 00 00 00 00 00
1F 00 01 00 D0 54 0D 00 1F 00 01 00 F8 54 0D 00 1F 00 01 00 3A 27 00 00 17 00 01 00 10 00 02 00 00 00 00 00
1F 00 01 00 92 4B 17 00 1F 00 01 00 AA 4B 17 00 1F 00 01 00 5F 40 00 00 17 00 01 00 11 00 02 00 00 00 00 00
1F 00 01 00 4A 4B 01 00 1F 00 01 00 5B 4B 01 00 1F 00 01 00 B9 0F 00 00 17 00 01 00 12 00 02 00 00 00 00 00
1F 00 01 00 66 4B 01 00 1F 00 01 00 A1 4B 01 00 1F 00 01 00 FF FF FF 0F 17 00 01 00 13 00 02 00 00 00 00 00
1F 00 01 00 C7 3A 00 00 1F 00 01 00 FC 3A 00 00 1F 00 01 00 DD 0A 00 00 17 00 01 00 14 00 02 00 00 00 00 00
- push text line
- push speaker (or 0x0fffffff if none)
- push voice file id (0x0fffffff if non-voiced line)
- syscall (0x00020002 or 0x0002000f or 0x00020014),0x00000000
* syscall 0x00020012 and 0x00020014 doesn't have a preceding push 0, the others have

chapter number/scene id/something
1F 00 01 00 79 37 00 00 17 00 01 00 02 00 0F 00 00 00 00 00
1F 00 01 00 25 01 00 00 17 00 01 00 02 00 0F 00 00 00 00 00
- push strptr
- syscall 0x000f0002,0x00000000

line 809,13387 in kizuna trial (not text)
11 00 01 00 01 00 00 40 02 00 63 64 0A 00 01 00 26 11 00 00 01 00 00 40 01 00 01 00 03 00 00 40 4B 34 00 00 01 00 01 00 00 00 00 40 03 00 00 40 1F 00 01 00 00 00 00 40 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 83 50 1F 00 01 00 00 00 00 40 17 00 01 00 3B 00 12 00

line 9023,345756 (last line) in kizuna trial (unknown thing)
1F 00 01 00 00 00 00 00 17 00 01 00 03 00 02 00 00 00 00 00 
0B 00 01 00 0D 00 00 00 1F 00 01 00 9C 46 05 00 17 00 01 00 15 00 0A 00 00 00 00 00
01 00 01 00 00 00 00 40 50 00 00 00
01 00 01 00 00 00 00 40 00 00 00 10
01 00 01 00 01 00 00 40
- push 0
- syscall 0x00020003,0x00000000
- call [0x0000000d] ?
- push strptr
- syscall 0x000a0015,0x00000000
- mov 0x40000000,0x00000005
- mov 0x40000000,0x10000000
- more mov
* haven't added this

choices
1F 00 01 00 D2 00 00 00 1F 00 01 00 21 0B 00 00 1F 00 01 00 2C 14 00 00 17 00 01 00 02 00 06 00 00 00 00 00
1F 00 01 00 E1 00 00 00 1F 00 01 00 22 0B 00 00 1F 00 01 00 45 14 00 00 17 00 01 00 02 00 06 00 00 00 00 00
1F 00 01 00 F0 00 00 00 1F 00 01 00 23 0B 00 00 1F 00 01 00 52 14 00 00 17 00 01 00 02 00 06 00 00 00 00 00
1F 00 01 00 D2 00 00 00 1F 00 01 00 9C 0A 00 00 1F 00 01 00 D7 8B 16 00 17 00 01 00 02 00 06 00 00 00 00 00
1F 00 01 00 E1 00 00 00 1F 00 01 00 9D 0A 00 00 1F 00 01 00 E8 8B 16 00 17 00 01 00 02 00 06 00 00 00 00 00
1F 00 01 00 01 00 00 40 1F 00 01 00 08 0F 00 00 1F 00 01 00 0F EA 04 00 17 00 01 00 02 00 06 00 01 00 00 00
1F 00 01 00 01 00 00 40 1F 00 01 00 0B 0F 00 00 1F 00 01 00 26 EA 04 00 17 00 01 00 02 00 06 00 01 00 00 00
1F 00 01 00 01 00 00 40 1F 00 01 00 0E 0F 00 00 1F 00 01 00 3B EA 04 00 17 00 01 00 02 00 06 00 01 00 00 00
1F 00 01 00 01 00 00 40 1F 00 01 00 11 0F 00 00 1F 00 01 00 54 EA 04 00 17 00 01 00 02 00 06 00 01 00 00 00
1F 00 01 00 73 00 00 00 09 00 01 00 67 07 00 00 1F 00 01 00 9A 8D 01 00 17 00 01 00 02 00 06 00 00 00 00 00
- push something unknown
- push something unknown
- push strptr
- syscall 0x00060002,(0x00000000 or 0x00000001)

choices from natsuiro kokoro log
-------------------------------------------------------------------------------
stuff for specific games

special text line from akatsuki yureru
1F 00 01 00 00 00 00 00 1F 00 01 00 01 55 04 00 1F 00 01 00 15 00 00 00 17 00 01 00 16 00 03 00 00 00 00 00
- push 0
- push strptr
- push voice file id i guess
- syscall 0x00030016,0x00000000

the tricky strings (a couple of latin alphabet names) at the end of the script
of koi x shin ai kanojo:
09 00 01 00 e6 0f 00 00 01 00 01 00 01 00 00 40 ## ## ## ## 1f 00 01 00 01 00 00 40 0b 00 01 00 e1 0f 00 00
- hopefully this one will never have false hits since it's so specific

staff roll commands in akatsuki yureru trial
1F 00 01 00 FF FF FF 0F 01 00 01 00 00 00 00 40 01 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 B0 82 06 00 17 00 01 00 5C 00 12 00 00 00 00 00
1F 00 01 00 FF FF FF 0F 01 00 01 00 00 00 00 40 01 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 CD 82 06 00 17 00 01 00 5C 00 12 00 00 00 00 00
- there are more common instructions before this, but this should be long enough
  for a robust identification

staff roll commands in natsuiro kokoro log (different from above)
1F 00 01 00 FF FF FF 0F 01 00 01 00 00 00 00 40 01 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 44 6A 20 00 17 00 01 00 04 00 0F 00 00 00 00 00
1F 00 01 00 FF FF FF 0F 01 00 01 00 00 00 00 40 01 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 5C 6A 20 00 17 00 01 00 04 00 0F 00 00 00 00 00

more roll commands, eyecatch command (0x00120009)
01 00 01 00 00 00 00 40 01 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 10 B9 1E 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 17 00 01 00 09 00 12 00 00 00 00 00
01 00 01 00 00 00 00 40 00 00 82 50 1F 00 01 00 00 00 00 40 1F 00 01 00 25 B9 1E 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 17 00 01 00 09 00 12 00 00 00 00 00
01 00 01 00 00 00 00 40 03 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 E8 69 20 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 81 50 1F 00 01 00 00 00 00 40 17 00 01 00 09 00 12 00 00 00 00 00
- this is long and hideous

website in leyline
1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FC BF 0A 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 17 00 01 00 09 00 12 00 00 00 00 00
1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 4C C0 0A 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 17 00 01 00 09 00 12 00 00 00 00 00
- as above, also 0x00120009

last lines from flyable heart trial
17 00 01 00 0B 00 12 00 00 00 00 00 0A 00 01 00 3D 03 00 00 00 00 00 40 1F 00 01 00 4F 22 02 00 17 00 01 00 01 00 0F 00 00 00 00 00
17 00 01 00 0B 00 12 00 00 00 00 00 0A 00 01 00 44 03 00 00 00 00 00 40 1F 00 01 00 6A 22 02 00 17 00 01 00 01 00 0F 00 00 00 00 00
17 00 01 00 0B 00 12 00 00 00 00 00 0A 00 01 00 4F 03 00 00 00 00 00 40 1F 00 01 00 85 22 02 00 17 00 01 00 01 00 0F 00 00 00 00 00
- there are more common instructions before this, but this should be sufficient!

backslash string at the end of kizuna fandisc
1F 00 01 00 00 00 00 40 17 00 01 00 32 00 12 00 00 00 00 00 1F 00 01 00 24 54 12 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 17 00 01 00 3B 00 12 00 00 00 00 00

character selection thing at end of kizuna trial and koi suru kokoro (0x000a0015)
1F 00 01 00 00 00 00 00 17 00 01 00 03 00 02 00 00 00 00 00 0B 00 01 00 0D 00 00 00 1F 00 01 00 9C 46 05 00 17 00 01 00 15 00 0A 00 00 00 00 00
1F 00 01 00 00 00 00 00 17 00 01 00 03 00 02 00 00 00 00 00 0B 00 01 00 30 00 00 00 1F 00 01 00 4A E4 1C 00 17 00 01 00 15 00 0A 00 00 00 00 00

selection of trial version (?) at the end of koi x shin ai kanojo trial (0x000a0015)
1F 00 01 00 00 00 00 00 17 00 01 00 0C 00 0A 00 00 00 00 00 1F 00 01 00 5C D1 06 00 17 00 01 00 15 00 0A 00 00 00 00 00
- too different from character selection thing, i guess. common match
  would be just push+syscall (though i suppose the syscall should be unique...)

play command at the end of koi suru kokoro (0x00070000)
1F 00 01 00 FF FF FF 0F 01 00 01 00 00 00 00 40 01 00 00 80 1F 00 01 00 00 00 00 40 1F 00 01 00 59 E4 1C 00 17 00 01 00 04 00 0F 00 00 00 00 00 1F 00 01 00 01 00 00 00 1F 00 01 00 DC 05 00 00 17 00 01 00 00 00 07 00 00 00 00 00
- probably a lot of garbage at the end here

proper names at the end of koi x sin ai konojo
09 00 01 00 E6 0F 00 00 01 00 01 00 01 00 00 40 4D F0 1C 00 1F 00 01 00 01 00 00 40 0B 00 01 00 E1 0F 00 00
09 00 01 00 E6 0F 00 00 01 00 01 00 01 00 00 40 56 F0 1C 00 1F 00 01 00 01 00 00 40 0B 00 01 00 E1 0F 00 00
09 00 01 00 E6 0F 00 00 01 00 01 00 01 00 00 40 60 F0 1C 00 1F 00 01 00 01 00 00 40 0B 00 01 00 E1 0F 00 00
09 00 01 00 E6 0F 00 00 01 00 01 00 01 00 00 40 68 F0 1C 00 1F 00 01 00 01 00 00 40 0B 00 01 00 E1 0F 00 00

summary of choices or choice label from leyline
1F 00 01 00 F9 13 00 00 17 00 01 00 00 00 0F 00 00 00 00 00
1F 00 01 00 7B 4B 00 00 17 00 01 00 00 00 0F 00 00 00 00 00
1F 00 01 00 88 73 00 00 17 00 01 00 00 00 0F 00 00 00 00 00
1F 00 01 00 79 14 00 00 17 00 01 00 00 00 0F 00 00 00 00 00
1F 00 01 00 F4 15 00 00 17 00 01 00 00 00 0F 00 00 00 00 00
1F 00 01 00 49 6D 01 00 17 00 01 00 00 00 0F 00 00 00 00 00

increase flag in leyline
1F 00 01 00 00 00 00 40 1F 00 01 00 1B 19 00 00 17 00 01 00 04 00 0F 00 00 00 00 00
1F 00 01 00 00 00 00 40 1F 00 01 00 4D 88 00 00 17 00 01 00 04 00 0F 00 00 00 00 00

i don't currently have high hopes of matching the early lines of a file
(before the actual text) because low addresses => low numbers
=> more search hits => more false hits (and arbitrary instructions)

%d %d, save folder, koi suru kokoro trial
01 00 01 00 00 00 00 40 00 00 00 50 1F 00 01 00 00 00 00 40 1F 00 01 00 94 78 05 00 17 00 01 00 5A 00 12 00 00 00 00 00
01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 1F 00 01 00 9E 78 05 00 17 00 01 00 5A 00 12 00 00 00 00 00
01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 1F 00 01 00 C9 78 05 00 17 00 01 00 5A 00 12 00 00 00 00 00
01 00 01 00 00 00 00 40 03 00 00 40 1F 00 01 00 00 00 00 40 1F 00 01 00 F9 7D 05 00 17 00 01 00 5A 00 12 00 00 00 00 00
01 00 01 00 00 00 00 40 03 00 00 40 1F 00 01 00 00 00 00 40 1F 00 01 00 06 7E 05 00 17 00 01 00 5A 00 12 00 00 00 00 00

**debug, koi suru kokoro trial
1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 36 8D 05 00 17 00 01 00 5A 00 12 00 00 00 00 00
1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 5D 8D 05 00 17 00 01 00 5A 00 12 00 00 00 00 00
1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 C5 8D 05 00 17 00 01 00 5A 00 12 00 00 00 00 00

koi suru kokoro trial, "1,2,3,4", "rarara"
01 00 01 00 02 00 00 40 1F 79 05 00 01 00 01 00 00 00 00 40 02 00 00 40 1F 00 01 00 00 00 00 40 17 00 01 00 73 00 12 00 00 00 00 00
01 00 01 00 02 00 00 40 5C 79 05 00 01 00 01 00 00 00 00 40 02 00 00 40 1F 00 01 00 00 00 00 40 17 00 01 00 73 00 12 00 00 00 00 00

koi suru kokoro trial, dunno, "press the button"
1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 FF FF FF 0F 1F 00 01 00 0F 58 05 00 17 00 01 00 04 00 0F 00 00 00 00 00

koi suru kokoro trial, music playlist
1F 00 01 00 B1 78 05 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 80 50 1F 00 01 00 00 00 00 40 17 00 01 00 3B 00 12 00 00 00 00 00


unity marriage text line
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 FF FF FF 0F 01 00 01 00 02 00 00 30 48 A9 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 FF FF FF 0F 01 00 01 00 02 00 00 30 7F A9 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 96 A9 00 00 01 00 01 00 02 00 00 30 A1 A9 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 E7 A9 00 00 01 00 01 00 02 00 00 30 F2 A9 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 51 AA 00 00 01 00 01 00 02 00 00 30 5C AA 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 BB 04 00 00 01 00 01 00 01 00 00 30 B9 2F 01 00 01 00 01 00 02 00 00 30 C4 2F 01 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 C8 19 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 C2 04 00 00 01 00 01 00 01 00 00 30 5B 31 01 00 01 00 01 00 02 00 00 30 66 31 01 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 02 00 02 00
01 00 01 00 00 00 00 30 72 01 00 00 01 00 01 00 01 00 00 30 7B 18 00 00 01 00 01 00 02 00 00 30 84 18 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 0F 00 02 00
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 DD 0D 00 00 01 00 01 00 02 00 00 30 E8 0D 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 11 00 02 00
01 00 01 00 00 00 00 30 28 02 00 00 01 00 01 00 01 00 00 30 DF 5A 00 00 01 00 01 00 02 00 00 30 E8 5A 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 E8 03 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 12 00 02 00
01 00 01 00 00 00 00 30 FF FF FF 0F 01 00 01 00 01 00 00 30 FB 5A 00 00 01 00 01 00 02 00 00 30 04 5B 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 03 00 00 30 00 00 00 40 17 00 01 00 13 00 02 00

unity marriage, different format
01 00 01 00 00 00 00 30 27 02 00 00 01 00 01 00 01 00 00 30 BD 5A 00 00 01 00 01 00 02 00 00 30 C6 5A 00 00 17 00 01 00 14 00 02 00

unity marriage, yet another different format
01 00 01 00 00 00 00 30 F4 C4 01 00 09 00 01 00 AD 02 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 01 00 00 30 00 00 00 40 17 00 01 00 02 00 06 00
01 00 01 00 00 00 00 30 05 C5 01 00 09 00 01 00 AE 02 00 00 08 00 01 00 00 00 00 40 00 00 00 40 01 00 01 00 00 00 00 40 00 00 00 00 01 00 01 00 01 00 00 30 00 00 00 40 17 00 01 00 02 00 06 00

unity marriage, text that appears gradually
01 00 01 00 00 00 00 30 27 02 00 00 01 00 01 00 01 00 00 30 BD 5A 00 00 01 00 01 00 02 00 00 30 C6 5A 00 00 17 00 01 00 14 00 02 00
01 00 01 00 00 00 00 30 80 02 00 00 01 00 01 00 01 00 00 30 FE 71 00 00 01 00 01 00 02 00 00 30 07 72 00 00 17 00 01 00 14 00 02 00
01 00 01 00 00 00 00 30 AE 02 00 00 01 00 01 00 01 00 00 30 23 83 00 00 01 00 01 00 02 00 00 30 2C 83 00 00 17 00 01 00 14 00 02 00

-------------
not yet matched

